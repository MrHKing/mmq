(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69d382d4"],{"0fea":function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return n}));var a=r("b775");function s(e,t){return Object(a["b"])({url:e,method:"post",data:t})}function o(e,t){return Object(a["b"])({url:e,method:"get",params:t})}function n(e,t){return Object(a["b"])({url:e,method:"delete",params:t})}},"253c1":function(e,t,r){},"7a56":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{attrs:{bordered:!1}},[r("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSave({})}}},[e._v("添加")]),r("div",{staticClass:"table-operator"}),r("a-list",{attrs:{grid:{gutter:16,column:4},"data-source":e.data},scopedSlots:e._u([{key:"renderItem",fn:function(t){return r("a-list-item",{},[r("a-card",{attrs:{title:t.title}},[r("div",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.resourceID))]),r("a",{attrs:{slot:"actions"},on:{click:function(r){return e.handleSave(t)}},slot:"actions"},[e._v("编辑")]),r("a",{attrs:{slot:"actions"},on:{click:function(r){return e.hanldeDelete(t)}},slot:"actions"},[e._v("删除")]),e._v(" "+e._s(e.getDescription(t))+" ")])],1)}}])}),r("ResourceModel",{ref:"ResourceModel",on:{ok:e.loadData}})],1)},s=[],o=r("0fea"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-drawer",{attrs:{confirmLoading:e.confirmLoading,title:"保存新资源",width:720,visible:e.visible,"body-style":{paddingBottom:"80px"}},on:{close:e.onClose}},[r("a-form",{attrs:{form:e.form,layout:"vertical","hide-required-mark":""}},[r("a-row",{attrs:{gutter:16}},[r("a-form-item",{attrs:{label:"资源类型"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"请选择资源类型"}]}],expression:"[\n            'type',\n            {\n              rules: [{ required: true, message: '请选择资源类型' }],\n            },\n          ]"}],attrs:{placeholder:"请选择资源类型"},on:{change:e.typeChange}},[r("a-select-option",{attrs:{value:"MYSQL"}},[e._v(" Mysql ")]),r("a-select-option",{attrs:{value:"POSTGRESQL"}},[e._v(" Postgresql ")]),r("a-select-option",{attrs:{value:"TDENGINE"}},[e._v(" Tdengine ")]),r("a-select-option",{attrs:{value:"INFLUXDB"}},[e._v(" InfluxDB ")]),r("a-select-option",{attrs:{value:"KAFKA"}},[e._v(" Kafka ")])],1)],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:"MYSQL"===e.type,expression:"type === 'MYSQL'"}]},[r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{label:"IP"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["resource.ip",{rules:[{required:!0,message:"请输入IP"}]}],expression:"[\n                'resource.ip',\n                {\n                  rules: [{ required: true, message: '请输入IP' }],\n                },\n              ]"}],attrs:{placeholder:"请输入IP"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{label:"PORT"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["resource.port",{rules:[{required:!0,message:"请输入端口"}]}],expression:"[\n                'resource.port',\n                {\n                  rules: [{ required: true, message: '请输入端口' }],\n                },\n              ]"}],attrs:{placeholder:"请输入端口"}})],1)],1)],1),r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{label:"数据库"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["resource.databaseName",{rules:[{required:!0,message:"请输入要连接的数据库"}]}],expression:"[\n                'resource.databaseName',\n                {\n                  rules: [{ required: true, message: '请输入要连接的数据库' }],\n                },\n              ]"}],attrs:{placeholder:"请输入要连接的数据库"}})],1)],1),r("a-col",{attrs:{span:12}})],1)],1),r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:24}},[r("a-form-item",{attrs:{label:"备注"}},[r("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!0,message:"请输入备注"}]}],expression:"[\n              'description',\n              {\n                rules: [{ required: true, message: '请输入备注' }],\n              },\n            ]"}],attrs:{rows:4,placeholder:"请输入备注"}})],1)],1)],1)],1),r("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[r("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" Cancel ")]),r("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" Submit ")])],1)],1)},i=[],c=(r("a4d3"),r("e01a"),r("d3b7"),{data:function(){return{title:"操作",visible:!1,confirmLoading:!1,type:"",form:this.$form.createForm(this),url:{save:"/v1/resources"}}},created:function(){},methods:{save:function(e){this.form.resetFields(),this.visible=!0,e&&this.setFieldsValueByType(e.type,e)},setFieldsValueByType:function(e,t){var r=this;switch(this.type=e,e){case"MYSQL":this.$nextTick((function(){r.form.setFieldsValue({resourceID:t.resourceID,type:e,description:t.description,resource:{ip:t.resource.ip,port:t.resource.port,databaseName:t.resource.databaseName}})}))}},typeChange:function(e){this.type=e},onClose:function(){this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(r,a){if(!r){t.confirmLoading=!0;var s=Object.assign({},a),n=Object(o["c"])(e.url.save,s);n.then((function(e){200===e.code?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.onClose()}))}}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleCancel:function(){this.onClose()}}}),u=c,l=r("2877"),d=Object(l["a"])(u,n,i,!1,null,"2af1a868",null),p=d.exports,m={name:"Subscribes",components:{ResourceModel:p},data:function(){return{loading:!0,data:[]}},filters:{},created:function(){this.loadData()},methods:{loadData:function(){var e=this;return Object(o["b"])("/v1/resources/resources",{}).then((function(t){e.data=t.data}))},getDescription:function(e){return"资源ID:"+e.resourceID+" 资源类型:"+e.type+this.getResourceContentByType(e.resource,e.type)},getResourceContentByType:function(e,t){switch(t){case"MYSQL":return" ip:"+e.ip+" port:"+e.port+" 数据库名称:"+e.databaseName;default:return""}},handleSave:function(e){this.$refs.ResourceModel.save(e)},hanldeDelete:function(e){var t=this;Object(o["a"])("/v1/resources",{resourceID:e.resourceID}).then((function(e){200===e.code?(t.$message.info(e.message),t.loadData()):t.$message.info(e.message)}))}}},f=m,v=(r("cb39"),Object(l["a"])(f,a,s,!1,null,null,null));t["default"]=v.exports},cb39:function(e,t,r){"use strict";r("253c1")}}]);