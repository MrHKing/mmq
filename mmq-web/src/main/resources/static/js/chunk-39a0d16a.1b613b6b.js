(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39a0d16a"],{3682:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"}),a("a-list",{attrs:{grid:{gutter:24,lg:3,md:2,sm:1,xs:1},loading:e.loading,"data-source":e.data},scopedSlots:e._u([{key:"renderItem",fn:function(t){return a("a-list-item",{},[a("a-card",{attrs:{title:t.moduleName}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.moduleName))]),a("img",{attrs:{slot:"cover",alt:"example",src:"https://gw.alipayobjects.com/zos/rmsportal/JiqGstEfoWAOHiTxclqi.png"},slot:"cover"}),a("template",{staticClass:"ant-card-actions",slot:"actions"},[a("a",{attrs:{slot:"actions"},on:{click:function(a){return e.handleUpdate(t)}},slot:"actions"},[e._v("编辑")]),a("a-switch",{attrs:{checked:t.enable},on:{change:function(a){return e.handleCheck(a,t)}}},[a("a-icon",{attrs:{slot:"checkedChildren",type:"check"},slot:"checkedChildren"}),a("a-icon",{attrs:{slot:"unCheckedChildren",type:"close"},slot:"unCheckedChildren"})],1)],1),e._v(" "+e._s(t.description)+" ")],2)],1)}}])}),a("AuthModuleModel",{ref:"AuthModuleModel",on:{ok:e.loadData}}),a("ApiModuleModel",{ref:"ApiModuleModel",on:{ok:e.loadData}}),a("AclModuleModel",{ref:"AclModuleModel",on:{ok:e.loadData}})],1)},s=[],o=a("0fea"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{confirmLoading:e.confirmLoading,title:"保存新资源",width:720,visible:e.visible,"body-style":{paddingBottom:"80px"}},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form,layout:"vertical","hide-required-mark":""}},[a("a-form-item",{attrs:{label:"资源类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["configs.resourceType",{rules:[{required:!0,message:"请选择资源类型"}]}],expression:"[\n          'configs.resourceType',\n          {\n            rules: [{ required: true, message: '请选择资源类型' }]\n          }\n        ]"}],attrs:{placeholder:"请选择资源类型"},on:{change:e.typeChange}},[a("a-select-option",{attrs:{value:"MYSQL"}},[e._v(" Mysql ")]),a("a-select-option",{attrs:{value:"POSTGRESQL"}},[e._v(" Postgresql ")]),a("a-select-option",{attrs:{value:"SQLSERVER"}},[e._v(" SqlServer ")])],1)],1),a("a-form-item",{attrs:{label:"资源id"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["configs.resourceId",{rules:[{required:!0,message:"请选择资源id"}]}],expression:"[\n          'configs.resourceId',\n          {\n            rules: [{ required: true, message: '请选择资源id' }]\n          }\n        ]"}],attrs:{placeholder:"请选择资源id"}},e._l(e.selectResources,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.resourceID}},[e._v(" "+e._s(t.resourceID)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"表名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["configs.table",{rules:[{required:!0,message:"请输入表名"}]}],expression:"['configs.table', { rules: [{ required: true, message: '请输入表名' }] }]"}],attrs:{placeholder:"请输入表名"}})],1),a("a-form-item",{attrs:{label:"账户字段"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["configs.username",{rules:[{required:!0,message:"请输入账户字段"}]}],expression:"['configs.username', { rules: [{ required: true, message: '请输入账户字段' }] }]"}],attrs:{placeholder:"请输入账户字段"}})],1),a("a-form-item",{attrs:{label:"密码字段"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["configs.password",{rules:[{required:!0,message:"请输入密码字段"}]}],expression:"['configs.password', { rules: [{ required: true, message: '请输入密码字段' }] }]"}],attrs:{placeholder:"请输入密码字段"}})],1)],1),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" Cancel ")]),a("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" Submit ")])],1)],1)},n=[],c=(a("159b"),a("a4d3"),a("e01a"),a("4de4"),a("d3b7"),{data:function(){return{title:"操作",visible:!1,curRecord:null,confirmLoading:!1,curResources:[],selectResources:[],type:"",form:this.$form.createForm(this),url:{listResources:"/v1/resources/resources",update:"/v1/modules"}}},created:function(){this.listResources()},methods:{listResources:function(){var e=this;Object(o["b"])(this.url.listResources,{}).then((function(t){e.curResources=[],t.data.forEach((function(t){e.curResources.push(t)}))}))},update:function(e){var t=this;this.form.resetFields(),this.visible=!0,this.curRecord=e,e&&(this.key=e.key,this.$nextTick((function(){t.form.setFieldsValue({key:e.key,enable:e.enable,description:e.description,icon:e.icon,modelEnum:e.modelEnum,configs:{resourceType:e.configs.resourceType,resourceId:e.configs.resourceId,table:e.configs.table,username:e.configs.username,password:e.configs.password}})})))},typeChange:function(e){this.selectResources=this.curResources.filter((function(t){return e===t.type})),this.curType=e},onClose:function(){this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(a,r){if(!a){t.confirmLoading=!0,e.curRecord.configs=r.configs;var s=Object.assign({},e.curRecord),i=Object(o["d"])(e.url.update,s);i.then((function(e){200===e.code?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.onClose()}))}}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleCancel:function(){this.onClose()}}}),l=c,d=a("2877"),u=Object(d["a"])(l,i,n,!1,null,"582b6de3",null),m=u.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{confirmLoading:e.confirmLoading,title:"保存新资源",width:720,visible:e.visible,"body-style":{paddingBottom:"80px"}},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form,layout:"vertical","hide-required-mark":""}},[a("a-form-item",{attrs:{label:"appId"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["configs.appId",{rules:[{required:!0,message:"请输入appId"}]}],expression:"['configs.appId', { rules: [{ required: true, message: '请输入appId' }] }]"}],attrs:{placeholder:"请输入appId"}})],1),a("a-form-item",{attrs:{label:"appSecret"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["configs.appSecret",{rules:[{required:!0,message:"请输入appSecret"}]}],expression:"['configs.appSecret', { rules: [{ required: true, message: '请输入appSecret' }] }]"}],attrs:{placeholder:"请输入appSecret"}})],1)],1),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" Cancel ")]),a("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" Submit ")])],1)],1)},p=[],h={data:function(){return{title:"操作",visible:!1,curRecord:null,confirmLoading:!1,curResources:[],selectResources:[],type:"",form:this.$form.createForm(this),url:{listResources:"/v1/resources/resources",update:"/v1/modules"}}},created:function(){this.listResources()},methods:{listResources:function(){var e=this;Object(o["b"])(this.url.listResources,{}).then((function(t){e.curResources=[],t.data.forEach((function(t){e.curResources.push(t)}))}))},update:function(e){var t=this;this.form.resetFields(),this.visible=!0,this.curRecord=e,e&&(this.key=e.key,this.$nextTick((function(){t.form.setFieldsValue({key:e.key,enable:e.enable,description:e.description,icon:e.icon,modelEnum:e.modelEnum,configs:{appSecret:e.configs.appSecret,appId:e.configs.appId}})})))},typeChange:function(e){this.selectResources=this.curResources.filter((function(t){return e===t.type})),this.curType=e},onClose:function(){this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(a,r){if(!a){t.confirmLoading=!0,e.curRecord.configs=r.configs;var s=Object.assign({},e.curRecord),i=Object(o["d"])(e.url.update,s);i.then((function(e){200===e.code?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.onClose()}))}}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleCancel:function(){this.onClose()}}},v=h,g=Object(d["a"])(v,f,p,!1,null,"11dbae70",null),b=g.exports,x=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("a-drawer",{attrs:{title:"ACL管理",width:1e3,visible:t.visible,"body-style":{paddingBottom:"80px"}},on:{close:t.onClose}},[r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"}},[r("a-row",{attrs:{gutter:48}},[r("a-col",{attrs:{md:8,sm:24}},[r("a-form-item",{attrs:{label:"客户端ID"}},[r("a-input",{attrs:{placeholder:""},model:{value:t.queryParam.clientId,callback:function(e){t.$set(t.queryParam,"clientId",e)},expression:"queryParam.clientId"}})],1)],1),r("a-col",{attrs:{md:8,sm:24}},[r("a-form-item",{attrs:{label:"TOPIC"}},[r("a-input",{attrs:{placeholder:""},model:{value:t.queryParam.topic,callback:function(e){t.$set(t.queryParam,"topic",e)},expression:"queryParam.topic"}})],1)],1),t.advanced?void 0:t._e(),r("a-col",{attrs:{md:t.advanced?24:8,sm:24}},[r("span",{staticClass:"table-page-search-submitButtons",style:t.advanced&&{float:"right",overflow:"hidden"}||{}},[r("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return e.queryParam={}}}},[t._v("重置")]),r("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v(" "+t._s(t.advanced?"收起":"展开")+" "),r("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)])],2)],1)],1),r("div",{staticClass:"table-operator"},[r("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSave({})}}},[t._v("添加")])],1),r("s-table",{ref:"table",attrs:{size:"default",rowKey:"key",columns:t.columns,data:t.loadData,alert:!0},scopedSlots:t._u([{key:"serial",fn:function(e,a,s){return r("span",{},[t._v(" "+t._s(s+1)+" ")])}},{key:"enable",fn:function(e){return r("span",{},[r("a-tag",{directives:[{name:"show",rawName:"v-show",value:e.enable,expression:"record.enable"}],attrs:{color:"red"}},[t._v(" 停止 ")]),r("a-tag",{directives:[{name:"show",rawName:"v-show",value:!e.enable,expression:"!record.enable"}],attrs:{color:"green"}},[t._v(" 启用 ")])],1)}},{key:"action",fn:function(e,a){return r("span",{},[[r("a",{on:{click:function(e){return t.handleSave(a)}}},[t._v("编辑")]),r("a-divider",{attrs:{type:"vertical"}}),t.list.length?r("a-popconfirm",{attrs:{title:"Sure to delete?"},on:{confirm:function(){return t.handleDelete(a)}}},[r("a",{attrs:{href:"javascript:;"}},[t._v("删除")])]):t._e()]],2)}}])})],1),r("a-modal",{attrs:{visible:t.formVisible,title:"Basic Modal"},on:{cancel:t.handleCancel,ok:t.handleOk},scopedSlots:t._u([{key:"footer",fn:function(){return[r("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("取消")]),r("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("确认")])]},proxy:!0}])},[r("a-form",{attrs:{form:t.form,layout:"vertical","hide-required-mark":""}},[r("a-form-item",{attrs:{label:"是否允许"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["allow",{rules:[{required:!0,message:"请选择是否允许"}]}],expression:"[\n            'allow',\n            {\n              rules: [{ required: true, message: '请选择是否允许' }]\n            }\n          ]"}],attrs:{placeholder:"请选择是否允许"}},[r("a-select-option",{attrs:{value:"0"}},[t._v(" 拒绝 ")]),r("a-select-option",{attrs:{value:"1"}},[t._v(" 允许 ")])],1)],1),r("a-form-item",{attrs:{label:"客户端ID"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["clientId",{rules:[{required:!0,message:"请输入客户端ID"}]}],expression:"['clientId', { rules: [{ required: true, message: '请输入客户端ID' }] }]"}],attrs:{placeholder:"请输入客户端ID"}})],1),r("a-form-item",{attrs:{label:"topic"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["topic",{rules:[{required:!1,message:"请输入topic"}]}],expression:"['topic', { rules: [{ required: false, message: '请输入topic' }] }]"}],attrs:{placeholder:"请输入topic"}})],1)],1)],1)],1)},y=[],k=(a("ac1f"),a("5319"),a("25f0"),a("2af9")),w=[{title:"#",scopedSlots:{customRender:"serial"}},{title:"是否允许",dataIndex:"allow"},{title:"客户端ID",dataIndex:"clientId"},{title:"topic",dataIndex:"topic"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],C={name:"Acl",components:{STable:k["b"],Ellipsis:k["a"]},data:function(){var e=this;return this.columns=w,{advanced:!1,confirmLoading:!1,visible:!1,formVisible:!1,current:null,dataSource:[],list:[],form:this.$form.createForm(this),queryParam:{},loadData:function(t){var a=Object.assign({},t,e.queryParam);return Object(o["b"])("/v1/api/acl/pageAcl",a).then((function(t){return e.dataSource=t.data.data,t.data}))},selectedRowKeys:[],selectedRows:[]}},created:function(){},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{update:function(e){this.list=e.configs.data,this.visible=!0},onClose:function(){this.visible=!1},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={}},handleDelete:function(e){var t=this;Object(o["a"])("/v1/api/acl",{id:e.id}).then((function(e){t.$message.success(e.message),t.$refs.table.refresh()}))},handleSave:function(e){var t=this;this.formVisible=!0,this.current=e,this.form.resetFields(),null!=e&&this.$nextTick((function(){t.form.setFieldsValue({id:e.id,allow:e.allow,ipaddr:e.ipaddr,username:e.username,clientId:e.clientId,access:e.access,topic:e.topic})}))},handleOk:function(){var e=this,t=this;this.formVisible=!1,this.form.validateFields((function(a,r){if(!a){var s,i=Object.assign({},r);e.current.id?(i.id=e.current.id,s=Object(o["d"])("/v1/api/acl",i)):s=Object(o["c"])("/v1/api/acl",i),s.then((function(a){200===a.code?(t.$message.success(a.message),t.$emit("ok"),e.$refs.table.refresh()):t.$message.warning(a.message)})).finally((function(){t.confirmLoading=!1,t.formVisible=!1}))}}))},handleCancel:function(){this.formVisible=!1},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,a="x"===e?t:3&t|8;return a.toString(16)}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}},O=C,_=Object(d["a"])(O,x,y,!1,null,"b6226fe2",null),R=_.exports,q={name:"Subscribes",components:{AuthModuleModel:m,ApiModuleModel:b,AclModuleModel:R},data:function(){return{loading:!0,data:[]}},filters:{},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,setTimeout((function(){return Object(o["b"])("/v1/modules/modules",{}).then((function(t){e.data=t.data,e.loading=!1}))}),1e3)},handleCheck:function(e,t){var a=this;t.enable=e;var r=Object(o["d"])("/v1/modules",t);r.then((function(e){200===e.code?a.$message.success(e.message):a.$message.warning(e.message)}))},handleUpdate:function(e){switch(e.key){case"AUTH-MODULE":this.$refs.AuthModuleModel.update(e);break;case"API-MODULE":this.$refs.ApiModuleModel.update(e);break;case"ACL-MODULE":this.$refs.AclModuleModel.update(e);break}}}},I=q,S=(a("435a"),Object(d["a"])(I,r,s,!1,null,"7baba6b2",null));t["default"]=S.exports},"435a":function(e,t,a){"use strict";a("dba2")},dba2:function(e,t,a){}}]);